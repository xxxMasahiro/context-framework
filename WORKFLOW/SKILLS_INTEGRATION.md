# WORKFLOW / SKILLS_INTEGRATION

## 1. 目的
- Skills統合の方針を「唯一の正」として固定し、運用のぶれを防ぐ
- ツール非依存の手順を再利用可能にし、再現性と監査性を高める

## 2. 位置づけ（SSOTの優先順位）
- **Charter → Mode → Artifacts → Skills**
- Skillsは上位方針に従属し、上位の定義を上書きしない

## 3. Skillsの定義（何をSkillsと呼ぶか／呼ばないか）
- Skillsと呼ぶもの:
  - 繰り返し実行される手順を、目的・前提・入力・出力・検証まで含めて再利用可能にしたもの
  - 変更内容がArtifactsに書き戻され、証跡が残るもの
- Skillsと呼ばないもの:
  - その場限りの作業メモ
  - 特定ツールの操作だけに依存する手順（共通化されていないもの）
  - 上位方針（Charter/Mode/Artifacts）を再定義する文書

## 4. 統合の原則
- **ツール非依存**: 中核手順は特定ツールに依存しない
- **再利用**: 入力と出力が明確で、他案件でも同じ形で使える
- **再現性**: 手順と検証が再実行可能で、結果の差分が追跡できる
- **粒度**: 1技能=1目的で完結し、Artifactsへ書き戻せる粒度にする

## 5. ツール依存の扱い（adapters分離のルール）
※ここでいう「ツール非依存」とは、対象サービス（例：Supabase/Stripe）への依存は許容しつつ、実行手段（例：Claude Code/Codex/Google Antigravity/GUI/CLI）に依存する手順は adapters に分離する、という意味である。

- Skills（共通）と adapters（ツール固有）を分離する
- **3ファイル（CLAUDE.md / AGENTS.md / GEMINI.md）はSSOTではなく運用アダプタ**として扱う

### 境界基準（箇条書き）
- Skills（共通）に含める:
  - 目的、前提、入力、出力、手順、検証、ロールバック
  - Artifactsへの書き戻し方法（Task Lists / Implementation Plan / Walkthrough への反映）
  - 監査に必要な証跡の種類
- adapters（ツール固有）に含める:
  - ツール固有の操作手順（UI/CLI/拡張機能/プロンプト形式）
  - 実行環境の差分（権限、設定、コマンド実行方法）
  - 出力フォーマットの違い（ログ形式、添付方法）

## 6. 参照関係（関連ファイルの置き場所）
- 3ファイル共存ルール: `WORKFLOW/TOOLING/COEXIST_3FILES.md`
- adaptersの置き場（将来追加前提）: `WORKFLOW/TOOLING/ADAPTERS/`
- Skillsの置き場（推奨）: `/SKILLS/`
- テンプレの置き場（推奨）: `/SKILLS/skill-template/`

## 7. 運用フロー（作成/更新/レビュー）
- 作成:
  - 目的と出力を固定し、手順と検証を最小限で定義する
- 更新:
  - 変更点（追加/削除/修正）を明示し、Artifactsへの影響を記録する
- レビュー:
  - 上位方針との整合（Charter/Mode/Artifacts）
  - ツール非依存性の維持（adaptersへの分離）
  - 再現性（検証手順と証跡の妥当性）

## 8. 例（2つだけ）
- 良い例（ツール非依存のSkills）:
  - 「外部API連携の追加」：前提/入力/出力/検証まで共通化し、実行方法はadaptersに分離
- 境界例（手順の一部がツール依存）:
  - 「CLIでのデプロイ」：共通の目的と検証はSkillsに残し、CLIコマンドや環境差分はadaptersへ分離

## 9. チェックリスト（最小条件）
- [ ] SSOT優先順位が明記されている
- [ ] Skillsの定義と非対象が区別されている
- [ ] ツール依存の境界基準が箇条書きで示されている
- [ ] 3ファイルがSSOTではなく運用アダプタであることと矛盾しない
- [ ] 参照関係と推奨配置が明記されている
- [ ] 作成/更新/レビューの運用フローがある
- [ ] 例が2つだけ示されている
