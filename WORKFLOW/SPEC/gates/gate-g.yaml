gate: G
phase: 1
steps:
  - id: STEP-G003
    title: "抽象ログ（索引）仕様合意"
    ssot:
      - path: "_handoff_check/update_runbook.md"
        must_contain:
          - "STEP-G003.*\\[x\\]"
          - "### LOG-009"
      - path: "LOGS/INDEX.md"
        generated: true
    invariants:
      - type: file_contains
        path: "LOGS/INDEX.md"
        pattern: "LOG-009"
    evidence_commands:
      - 'rg -n "STEP-G003.*\\[x\\]" _handoff_check/update_runbook.md 2>/dev/null || grep -nE "STEP-G003.*\\[x\\]" _handoff_check/update_runbook.md 2>/dev/null || true'
      - 'rg -n "^### LOG-009" _handoff_check/update_runbook.md 2>/dev/null || grep -nE "^### LOG-009" _handoff_check/update_runbook.md 2>/dev/null || true'
      - 'rg -n "LOG-009" LOGS/INDEX.md 2>/dev/null || grep -nE "LOG-009" LOGS/INDEX.md 2>/dev/null || true'
    next_action: "./tools/guard.sh -- ./tools/log-index.sh"
    notes:
      - "doctor Phase 0: このYAMLを読まず、決め打ちチェックのみ実行する（文書化用）"
